{% extends "base.html" %}
{% load i18n %}

{% block content %}

<ul class="messages error">
    {% for error in form.non_field_errors %}
        <li>{{ error }}</li>
    {% endfor %}
</ul>


<form method="post" action="." class="ui form">
    {% csrf_token %}
    {{ wizard.management_form }}
    {% if wizard.steps.current == 'auth' %}
        <h1 class="ui medium header">{% trans "Welcome, please login." %}</h1>

        <fieldset style="border:none;">
            <div class="field">
                <label for="id_auth-username">{% trans "Email" %}</label>
                {{ form.errors.username }}
                {{ form.username }}
            </div>
            <div class="field">
                <label for="id_auth-password">{% trans "Password" %}</label>
                {{ form.errors.password }}
                {{ form.password }}
            </div>

            <div class="field">
		<div class="ui checkbox">
		        {{ form.errors.is_persistent }}
		        {{ form.is_persistent }}
		        <label for="id_auth-is_persistent">{% trans "Remember me" %}</label>
		</div>
            </div>

            <div class="login__buttons">
                <button name="login" class="fluid ui button primary" type="submit">{% trans "Login" %}</button>

                <div class="forgot-password">
                    <div class="ui list">
                        <a class="item" href="{% url 'password_reset' %}">{% trans "Forgot password" %}</a>
                        <div><span style="margin-right:5px">{% trans "Don't have an account?" %}</span><a class="item" href="{% url 'register' %}">{% trans "Register" %}</a></div>
                    </div>
                </div>
            </div>
        </fieldset>
        <input type="hidden" name="next" value="{{next}}" />
        <p></p>
    {% elif wizard.steps.current == 'token' %}

    <script type="text/javascript">
      window.onload = function() {
         {
          document.getElementById("id_token-otp_token").focus();
        }
      };
    </script>
    <p>{% trans "Please fill in a two-factor code" %}</p>
        <div class="input-field">
            {{ form.errors.otp_token }}
            {{ form.otp_token.label_tag }}
            {{ form.otp_token }}
        </div>
        <button name="volgende" class="button ___stretch ___active login__login" type="submit">{% trans "Login" %}</button>
    {% elif wizard.steps.current == 'backup' %}
    <script type="text/javascript">
      window.onload = function() {
         {
          document.getElementById("id_backup-otp_token").focus();
        }
      };
    </script>
    <p>{% blocktrans %}Use this form for entering backup tokens for logging in.
         These tokens have been generated for you to print and keep safe. Please
             enter one of these backup tokens to login to your account.{% endblocktrans %}</p>
        <div class="input-field">
            <label for="id_backup-otp_token">Token:</label>
            <input id="id_backup-otp_token" name="backup-otp_token" type="text">
            <button name="wizard_goto_step" type="submit" class="button ___stretch ___active">{% trans "Use backuptoken" %}</button>
            <button name="wizard_goto_step" type="submit" value="auth" class="button ___stretch ___active">{% trans "Back" %}</button>
        </div>

    {% endif %}
        {% if backup_tokens %}
      <p>{% trans "As a last resort, you can use a backup token:" %}</p>
        <div class="input-field">
            <button name="wizard_goto_step" type="submit" value="backup" class="button ___stretch ___active">{% trans "Use backuptoken" %}</button>
            <button name="wizard_goto_step" type="submit" value="auth" class="button ___stretch ___active">{% trans "Back" %}</button>
        </div>

    {% endif %}

</form>
{% endblock %}
